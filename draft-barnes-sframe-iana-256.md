---
title: "Updates to SFrame Cipher Suites Registry"
abbrev: "SFrame IANA Updates"
category: info

docname: draft-barnes-sframe-iana-256-latest
submissiontype: IETF
number:
date:
consensus: true
v: 3
area: "Applications and Real-Time"
workgroup: "Secure Media Frames"
keyword:
 - SFrame
 - cryptography
venue:
  group: "Secure Media Frames"
  type: "Working Group"
  mail: "sframe@ietf.org"
  arch: "https://mailarchive.ietf.org/arch/browse/sframe/"
  github: "bifurcation/sframe-iana-256"
  latest: "https://bifurcation.github.io/sframe-iana-256/draft-barnes-sframe-iana-256.html"

author:
 -
    fullname: Richard Barnes
    organization: Cisco
    email: rlb@ipv.sx
 -
    fullname: Emad Omara
    organization: Apple
    email: eomara@apple.com
 -
    fullname: Aron Rosenberg
    organization: Apple
    email: aron.rosenberg@apple.com


normative:

informative:
  TestVectors:
    title: "SFrame Test Vectors"
    target: https://github.com/bifurcation/sframe-iana-256/blob/main/test-vectors/test-vectors-aes256.json
    date: 2025-09

--- abstract

This document addresses two omissions in the Secure Frames (SFrame) protocol
specification.  First, the definition of the IANA registry for SFrame
ciphersuites omits several important fields.  This document requests that IANA
add those fields and defines the contents of those fields for current entries.
Second, the AEAD construction based on AES-CTR and HMAC is defined only for
the 128-bit security level.  This document registers parallel constructions
at the 256-bit security level.

--- middle

# Introduction

The Secure Frames (SFrame) protocol specification defines an IANA registry for
cipher suites.  The initial definition in {{Section 8.1 of !RFC9605}} is missing
several important fields.  This document requests that IANA add those fields and
defines the contents of those fields for current entries.  We also define new
entries that extend the SFrame CTR+HMAC construction to support AES-256.

This document addresses two omissions in the Secure Frames (SFrame) protocol
specification {{!RFC9605}}.  First, the definition in {{Section 8.1 of
!RFC9605}} of the IANA registry for SFrame ciphersuites omits several important
fields.  This document requests that IANA add those fields and defines the
contents of those fields for current entries.  Second, the AEAD construction
based on AES-CTR and HMAC (in {{Section 4.5.1 of !RFC9605}}) is defined only for
the 128-bit security level.  This document registers parallel constructions at
the 256-bit security level.

# Conventions and Definitions

{::boilerplate bcp14-tagged}

# AES-256-CTR with HMAC-SHA512

{{Section 4.5.1 of !RFC9605}} defines a compound authenticated encryption
construction, using the unauthenticated CTR mode of AES for encryption and HMAC
for authentication.

The original specification only defines cipher suite values for instances of
this construction using AES-128-CTR and HMAC-SHA256.  The construction works the
same way when used with AES-256-CTR and HMAC-SHA512.  The only differences are
in the lengths of some SFrame-internal fields:

* The keys generated by SFrame-internal key derivation (`derive_key_salt`) are
  longer to match the needs of AES-256-CTR and HMAC-SHA512 (96 bytes vs 48 bytes
  for AES-128-CTR and HMAC-SHA256).

* The initial tag value `tag` in `compute_tag` is 64 bytes instead of 32 bytes.

Identifiers for cipher suites using AES-256-CTR and HMAC-SHA512 are defined in
{{cipher-suites}}.

# Security Considerations

The registry changes in this document have no affect on the security of SFrame.

The new algorithms registered by this document allow the CTR+HMAC construction
to be used in environments that require a 256-bit security level.

# IANA Considerations

This document makes two requests of IANA: Updating the columns in the "SFrame
Cipher Suites" registry and adding entries to the updated registry for the new
cipher suites defined in this document.

## "SFrame Cipher Suites" Registry Update {#sframe-cipher-suites}

The SFrame Cipher Suites registry should be updated to add the following
columns:

* `Nh`: The size in bytes of the output of the hash function

* `Nka`: For cipher suites using the compound AEAD described in {{Section 4.5.1
  of RFC9605}}, the size in bytes of a key for the underlying encryption
  algorithm

* `Nk`: The size in bytes of a key for the encryption algorithm

* `Nn`: The size in bytes of a nonce for the encryption algorithm

* `Nt`: The overhead in bytes of the encryption algorithm (typically the size of
  a "tag" that is added to the plaintext)

The "Change Controller" entry should be removed.

{{new-cipher-suite-registry}} illustrates the new structure of the registry, and provides
the required values for the currently registered entries.

| Value           | Name                          | Nh | Nka | Nk | Nn | Nt | R | Reference |
|:----------------|:------------------------------|:---|:----|:---|:---|:---|:--|:----------|
| 0x0000          | Reserved                      | -  | -   | -  | -  | -  | - | RFC 9605  |
| 0x0001          | `AES_128_CTR_HMAC_SHA256_80`  | 32 | 16  | 48 | 12 | 10 | Y | RFC 9605  |
| 0x0002          | `AES_128_CTR_HMAC_SHA256_64`  | 32 | 16  | 48 | 12 |  8 | Y | RFC 9605  |
| 0x0003          | `AES_128_CTR_HMAC_SHA256_32`  | 32 | 16  | 48 | 12 |  4 | Y | RFC 9605  |
| 0x0004          | `AES_128_GCM_SHA256_128`      | 32 | n/a | 16 | 12 | 16 | Y | RFC 9605  |
| 0x0005          | `AES_256_GCM_SHA512_128`      | 64 | n/a | 32 | 12 | 16 | Y | RFC 9605  |
| 0xF000 - 0xFFFF | Reserved for Private Use      | -  | -   | -  | -  | -  | - | RFC 9605  |
{: #new-cipher-suite-registry title="New structure and contents of the SFrame Cipher Suites registry" }

## Cipher Suites for AES-256-CTR with HMAC-SHA512 {#cipher-suites}

The following new entries should be added to the SFrame Cipher Suites registry:

| Value           | Name                          | Nh | Nka | Nk | Nn | Nt | R | Reference |
|:----------------|:------------------------------|:---|:----|:---|:---|:---|:--|:----------|
| 0x0006          | `AES_256_CTR_HMAC_SHA512_80`  | 64 | 32  | 96 | 12 | 10 | Y | RFC XXXX  |
| 0x0007          | `AES_256_CTR_HMAC_SHA512_64`  | 64 | 32  | 96 | 12 |  8 | Y | RFC XXXX  |
| 0x0008          | `AES_256_CTR_HMAC_SHA512_32`  | 64 | 32  | 96 | 12 |  4 | Y | RFC XXXX  |
{: #new-entries title="New entries SFrame Cipher Suites registry" }


--- back

# Test Vectors

This section provides a set of test vectors that implementations can use to
verify that they correctly implement SFrame encryption and decryption with the
cipher suites registered in this document.  Test vectors are provided for both
the AES-256-CTR-HMAC construction and for full SFrame encryption with the new
cipher suites.

All values are either numeric or byte strings.  Numeric values are represented
as hex values, prefixed with `0x`.  Byte strings are represented in hex
encoding.

Line breaks and whitespace within values are inserted to conform to the width
requirements of the RFC format.  They should be removed before use.

These test vectors are also available in JSON format at {{TestVectors}}.  In the
JSON test vectors, numeric values are JSON numbers and byte string values are
JSON strings containing the hex encoding of the byte strings.

## AEAD Encryption/Decryption Using AES-CTR and HMAC

For each case, we provide:

* `cipher_suite`: The index of the cipher suite in use (see
  {{sframe-cipher-suites}})
* `key`: The `key` input to encryption/decryption
* `enc_key`: The encryption subkey produced by the `derive_subkeys()` algorithm
* `auth_key`: The encryption subkey produced by the `derive_subkeys()` algorithm
* `nonce`: The `nonce` input to encryption/decryption
* `aad`: The `aad` input to encryption/decryption
* `pt`: The plaintext
* `ct`: The ciphertext

An implementation should verify that the following are true, where
`AEAD.Encrypt` and `AEAD.Decrypt` are as defined in {{Section 4.5.1 of RFC9605}}:

* `AEAD.Encrypt(key, nonce, aad, pt) == ct`
* `AEAD.Decrypt(key, nonce, aad, ct) == pt`

The other values in the test vector are intermediate values provided to
facilitate debugging of test failures.

{::include test-vectors/aes256-ctr-hmac.md}

## SFrame Encryption/Decryption

For each case, we provide:

* `cipher_suite`: The index of the cipher suite in use (see
  {{sframe-cipher-suites}})
* `kid`: A KID value
* `ctr`: A CTR value
* `base_key`: The `base_key` input to the `derive_key_salt` algorithm
* `sframe_key_label`: The label used to derive `sframe_key` in the `derive_key_salt` algorithm
* `sframe_salt_label`: The label used to derive `sframe_salt` in the `derive_key_salt` algorithm
* `sframe_secret`: The `sframe_secret` variable in the `derive_key_salt` algorithm
* `sframe_key`: The `sframe_key` value produced by the `derive_key_salt` algorithm
* `sframe_salt`: The `sframe_salt` value produced by the `derive_key_salt` algorithm
* `metadata`: The `metadata` input to the SFrame `encrypt` algorithm
* `pt`: The plaintext
* `ct`: The SFrame ciphertext

An implementation should verify that the following are true, where
`encrypt` and `decrypt` are as defined in {{Section 4.4 of RFC9605}}, using an SFrame
context initialized with `base_key` assigned to `kid`:

* `encrypt(ctr, kid, metadata, plaintext) == ct`
* `decrypt(metadata, ct) == pt`

The other values in the test vector are intermediate values provided to
facilitate debugging of test failures.

{::include test-vectors/sframe-aes256-ctr-hmac.md}
